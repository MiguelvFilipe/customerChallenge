<div *ngIf="errorMessage">{{ errorMessage }}</div>
<div>
  <button (click)="onPrevPage()" [disabled]="isLoading || currentPage === 1">Previous</button>
  <span>Page {{ currentPage }}</span>
  <button (click)="onNextPage()" [disabled]="isLoading || !hasMoreData">Next</button>
  <select [(ngModel)]="limit" (change)="onLimitChange(limit)" [disabled]="isLoading">
    <option value="2">2</option>
    <option value="5">5</option>
    <option value="10">10</option>
  </select>
</div>
<div>
  <label>
    <input type="checkbox" [(ngModel)]="showHasContract" (change)="onShowHasContractChange()" />
    Show Only Customers with Contract
  </label>
</div>
<div>
  <input type="text" [(ngModel)]="searchQuery" placeholder="Search by first or last name" />
  <select [(ngModel)]="searchType">
    <option value="firstName">First Name</option>
    <option value="lastName">Last Name</option>
  </select>
  <button (click)="onSearch()" [disabled]="isLoading">Search</button>
  <button (click)="clearSearch()" [disabled]="isLoading || !isInSearchMode">Clear Search</button>
</div>
<div>
  <button (click)="refreshData()" [disabled]="isLoading">Refresh Data</button>
</div>

<!-- Customer list section with loading overlay -->
<div class="customer-list-container" style="position: relative; min-height: 100px;">
  <!-- Loading overlay just for the list -->
  <div *ngIf="isLoading" class="loading-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.7); display: flex; justify-content: center; align-items: center; z-index: 10;">
    Loading...
  </div>

  <div *ngIf="noDataMessage">{{ noDataMessage }}</div>
  <ul *ngIf="!noDataMessage">
    <li
      *ngFor="let customer of customerList.customerList"
      (click)="onCustomerClick(customer.id)"
    >
      <h1>{{ customer.firstName }} <span *ngIf="isBirthdayThisMonth(customer.birthDate)">ðŸŽ‚</span></h1>
      <button (click)="$event.stopPropagation(); onDeleteCustomer(customer.id)">Delete</button>
      <button (click)="$event.stopPropagation(); onEditCustomer(customer.id)">Edit</button>
    </li>
  </ul>
</div>

<!-- Edit Customer Form -->
<div *ngIf="editCustomer">
  <h2>Edit Customer</h2>
  <div>
    <label>First Name:</label>
    <input type="text" [(ngModel)]="editCustomer.firstName" required [class.invalid]="formErrors.editCustomer.firstName" />
    <div *ngIf="formErrors.editCustomer.firstName" class="error-message">{{ formErrors.editCustomer.firstName }}</div>
  </div>
  <div>
    <label>Last Name:</label>
    <input type="text" [(ngModel)]="editCustomer.lastName" required [class.invalid]="formErrors.editCustomer.lastName" />
    <div *ngIf="formErrors.editCustomer.lastName" class="error-message">{{ formErrors.editCustomer.lastName }}</div>
  </div>
  <div>
    <label>Birth Date:</label>
    <input type="date" [(ngModel)]="editCustomer.birthDate" />
  </div>
  <div>
    <label>Email:</label>
    <input type="email" [(ngModel)]="editCustomer.email" [class.invalid]="formErrors.editCustomer.email" />
    <div *ngIf="formErrors.editCustomer.email" class="error-message">{{ formErrors.editCustomer.email }}</div>
  </div>
  <div>
    <label>Avatar URL:</label>
    <input type="text" [(ngModel)]="editCustomer.avatar" />
  </div>
  <div>
    <label>
      <input type="checkbox" [(ngModel)]="editCustomer.hasContract" />
      Has Contract
    </label>
  </div>
  <button (click)="onUpdateCustomer()">Update Customer</button>
  <button (click)="resetEditCustomerForm()">Cancel</button>
</div>

<!-- Create Customer Form -->
<div>
  <h2>Create New Customer</h2>
  <div>
    <label>First Name:</label>
    <input type="text" [(ngModel)]="newCustomer.firstName" required [class.invalid]="formErrors.newCustomer.firstName" />
    <div *ngIf="formErrors.newCustomer.firstName" class="error-message">{{ formErrors.newCustomer.firstName }}</div>
  </div>
  <div>
    <label>Last Name:</label>
    <input type="text" [(ngModel)]="newCustomer.lastName" required [class.invalid]="formErrors.newCustomer.lastName" />
    <div *ngIf="formErrors.newCustomer.lastName" class="error-message">{{ formErrors.newCustomer.lastName }}</div>
  </div>
  <div>
    <label>Birth Date:</label>
    <input type="date" [(ngModel)]="newCustomer.birthDate" />
  </div>
  <div>
    <label>Email:</label>
    <input type="email" [(ngModel)]="newCustomer.email" [class.invalid]="formErrors.newCustomer.email" />
    <div *ngIf="formErrors.newCustomer.email" class="error-message">{{ formErrors.newCustomer.email }}</div>
  </div>
  <div>
    <label>Avatar URL:</label>
    <input type="text" [(ngModel)]="newCustomer.avatar" />
  </div>
  <div>
    <label>
      <input type="checkbox" [(ngModel)]="newCustomer.hasContract" />
      Has Contract
    </label>
  </div>
  <button (click)="onCreateCustomer()">Create Customer</button>
</div>
